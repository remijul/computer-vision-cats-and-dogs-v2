{% extends "base.html" %}

{% block title %}Monitoring - Cats vs Dogs Classifier{% endblock %}

{% block content %}
<!-- Container élargi -->
<div class="container-fluid px-4" style="max-width: 1400px;">
    <div class="row mb-4">
        <div class="col-12">
            <h2 class="mb-0">
                <i class="bi bi-graph-up"></i> Dashboard de Monitoring
            </h2>
            <p class="text-muted">Surveillance en temps réel des performances et de la satisfaction utilisateur</p>
        </div>
    </div>
    
    {% if error %}
    <div class="alert alert-danger">
        {{ error }}
    </div>
    {% else %}
    
    <div class="row">
        <!-- COLONNE GAUCHE : Temps d'inférence -->
        <div class="col-lg-6 mb-4">
            <!-- KPI Temps d'inférence -->
            <div class="card shadow mb-4">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">
                        <i class="bi bi-clock-history"></i> Temps d'inférence
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row text-center">
                        <div class="col-4">
                            <h3 class="text-primary mb-0">{{ kpi_inference.avg_inference_time_ms }}</h3>
                            <small class="text-muted">ms moyen</small>
                        </div>
                        <div class="col-4">
                            <h5 class="text-success mb-0">{{ kpi_inference.min_inference_time_ms }}</h5>
                            <small class="text-muted">ms min</small>
                        </div>
                        <div class="col-4">
                            <h5 class="text-danger mb-0">{{ kpi_inference.max_inference_time_ms }}</h5>
                            <small class="text-muted">ms max</small>
                        </div>
                    </div>
                    <hr>
                    <p class="text-center mb-0">
                        <i class="bi bi-clipboard-data"></i> 
                        <strong>{{ kpi_inference.total_predictions }}</strong> prédictions réalisées
                    </p>
                </div>
            </div>
            
            <!-- Graphique temps d'inférence -->
            <div class="card shadow">
                <div class="card-header bg-light">
                    <h6 class="mb-0">
                        <i class="bi bi-graph-up"></i> Évolution temporelle
                    </h6>
                </div>
                <div class="card-body p-2">
                    {{ chart_inference|safe }}
                </div>
            </div>
        </div>
        
        <!-- COLONNE DROITE : Satisfaction utilisateur -->
        <div class="col-lg-6 mb-4">
            <!-- KPI Satisfaction -->
            <div class="card shadow mb-4">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0">
                        <i class="bi bi-emoji-smile"></i> Satisfaction utilisateur
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row text-center">
                        <div class="col-4">
                            <h3 class="text-success mb-0">{{ kpi_satisfaction.satisfaction_rate }}%</h3>
                            <small class="text-muted">de satisfaction</small>
                        </div>
                        <div class="col-4">
                            <h5 class="text-success mb-0">
                                <i class="bi bi-hand-thumbs-up-fill"></i> {{ kpi_satisfaction.positive_feedbacks }}
                            </h5>
                            <small class="text-muted">satisfait(s)</small>
                        </div>
                        <div class="col-4">
                            <h5 class="text-danger mb-0">
                                <i class="bi bi-hand-thumbs-down-fill"></i> {{ kpi_satisfaction.negative_feedbacks }}
                            </h5>
                            <small class="text-muted">insatisfait(s)</small>
                        </div>
                    </div>
                    <hr>
                    <p class="text-center mb-0">
                        <i class="bi bi-chat-square-text"></i> 
                        <strong>{{ kpi_satisfaction.total_feedbacks }}</strong> feedbacks collectés
                    </p>
                </div>
            </div>
            
            <!-- Graphique satisfaction -->
            <div class="card shadow">
                <div class="card-header bg-light">
                    <h6 class="mb-0">
                        <i class="bi bi-scatter-chart"></i> Distribution temporelle
                    </h6>
                </div>
                <div class="card-body p-2">
                    {{ chart_satisfaction|safe }}
                </div>
            </div>
        </div>
    </div>
    
    {% endif %}
</div>
{% endblock %}